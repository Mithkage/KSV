<Project Sdk="Microsoft.NET.Sdk.WindowsDesktop">

	<PropertyGroup>
		<TargetFramework>net48</TargetFramework>
		<PlatformTarget>x64</PlatformTarget>

		<ProjectGuid>24500748-F734-4C0E-BB02-9C6D8F8E5CC9</ProjectGuid>
		<OutputType>Library</OutputType>
		<RootNamespace>RTS</RootNamespace>
		<AssemblyName>RTS</AssemblyName>

		<LangVersion>9.0</LangVersion>
		<UseWindowsForms>true</UseWindowsForms>
		<UseWPF>true</UseWPF>

		<GenerateAssemblyInfo>false</GenerateAssemblyInfo>

		<Company>ReTick Solutions</Company>
		<Product>RTS Revit Add-in</Product>
		<Description>Revit Add-in for ReTick Solutions</Description>
		<Copyright>Copyright Â© ReTick Solutions 2025</Copyright>
		<Version>1.0.0.0</Version>
	</PropertyGroup>

	<ItemGroup>
		<None Remove="Resources\Icon_PC_Launcher.png" />
	</ItemGroup>

	<ItemGroup>
		<Content Include="Resources\Icon_PC_Launcher.png">
			<CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
		</Content>
	</ItemGroup>

	<ItemGroup>
		<PackageReference Include="ClosedXML" Version="0.102.2" />
		<PackageReference Include="DocumentFormat.OpenXml" Version="2.20.0" />
	</ItemGroup>

	<ItemGroup>
		<Reference Include="RevitAPI">
			<HintPath>C:\Program Files\Autodesk\Revit 2024\RevitAPI.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="RevitAPIUI">
			<HintPath>C:\Program Files\Autodesk\Revit 2024\RevitAPIUI.dll</HintPath>
			<Private>False</Private>
		</Reference>
		<Reference Include="Microsoft.VisualBasic" />
	</ItemGroup>

	<Target Name="CopyAddinFilesAfterBuild" AfterTargets="Build">
		<PropertyGroup>
			<RevitAddinsFolder>C:\ProgramData\Autodesk\Revit\Addins\2024\</RevitAddinsFolder>
			<AddinFileSource>$(ProjectDir)RTS.addin</AddinFileSource>
		</PropertyGroup>

		<Message Text="Copying Add-in DLL to $(RevitAddinsFolder)..." Importance="high" />
		<Exec Command="copy &quot;$(TargetDir)$(TargetName).dll&quot; &quot;$(RevitAddinsFolder)&quot; /Y" />

		<Message Text="Copying ClosedXML.dll to $(RevitAddinsFolder)..." Importance="high" />
		<Exec Command="copy &quot;$(TargetDir)ClosedXML.dll&quot; &quot;$(RevitAddinsFolder)&quot; /Y" />

		<Message Text="Copying DocumentFormat.OpenXml.dll to $(RevitAddinsFolder)..." Importance="high" />
		<Exec Command="copy &quot;$(TargetDir)DocumentFormat.OpenXml.dll&quot; &quot;$(RevitAddinsFolder)&quot; /Y" />

		<Message Text="Copying System.IO.Packaging.dll if it exists in TargetDir..." Importance="high" />
		<Exec Command="copy &quot;$(TargetDir)System.IO.Packaging.dll&quot; &quot;$(RevitAddinsFolder)&quot; /Y" Condition="Exists('$(TargetDir)System.IO.Packaging.dll')" />

		<Message Text="Copying SixLabors.Fonts.dll if it exists in TargetDir..." Importance="high" />
		<Exec Command="copy &quot;$(TargetDir)SixLabors.Fonts.dll&quot; &quot;$(RevitAddinsFolder)&quot; /Y" Condition="Exists('$(TargetDir)SixLabors.Fonts.dll')" />

		<Message Text="Copying .addin file from $(AddinFileSource) to $(RevitAddinsFolder)..." Importance="high" />
		<Exec Command="copy &quot;$(AddinFileSource)&quot; &quot;$(RevitAddinsFolder)&quot; /Y" />

	</Target>

</Project>
