<!--
FILE: LinkManagerWindow.xaml (UPDATED)

Function: This file defines the user interface for the Revit Link Manager WPF window.
          It includes the DataGrid for displaying Revit link metadata, filtering controls,
          and action buttons for import, export, and managing settings.

Change Log:
- July 30, 2025: Added a "Profile Settings" button to the main action panel.
- July 23, 2025: Added a read-only "Coordinates" column to display link transform data.
- July 23, 2025: Added a "Pinned" column with a three-state checkbox for managing link instance pin status.
- August 1, 2025: Added a "Project Roles & Contacts" grid to display project roles and contact information.
- August 2, 2025: Added a "Project Status" column to the Management tab.
- August 3, 2025: Added context menu options to the "File Name" column in the Dashboard tab.
- August 6, 2025: Applied the "File Name" context menu to the Management tab for UI consistency.
- August 6, 2025: Changed ComboBox fields in the 'Contacts' tab to standard text input fields for direct user entry.
- August 6, 2025: Removed loading indicator and standardized column widths across all tabs.
- August 6, 2025: Corrected XAML structure by moving the action buttons StackPanel inside the main Grid.
-->
<Window x:Class="RTS.UI.LinkManagerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:RTS.UI"
        mc:Ignorable="d"
        Title="RTS Link Hub" Height="722" Width="2191" 
        WindowStartupLocation="CenterScreen"
        ShowInTaskbar="False"
        Topmost="True"
        Background="#FFE0F2F1"
        MinWidth="900" MinHeight="450">

    <!-- Resource Dictionary for Styles -->
    <Window.Resources>
        <!-- Modern Button Style -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF26A69A"/>
            <Setter Property="Foreground" Value="White" />
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="BorderBrush" Value="#FF00796B"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#FF616161" Direction="270" ShadowDepth="2" BlurRadius="4" Opacity="0.4"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="8" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF4DB6AC"/>
                    <Setter Property="BorderBrush" Value="#FF00897B"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#FF00897B"/>
                    <Setter Property="BorderBrush" Value="#FF00695C"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#FFBDBDBD"/>
                    <Setter Property="Foreground" Value="#FF757575"/>
                    <Setter Property="BorderBrush" Value="#FF9E9E9E"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- DataGrid Styles -->
        <Style TargetType="{x:Type DataGridColumnHeader}">
            <Setter Property="Background" Value="#FF00897B"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>
        <Style TargetType="{x:Type DataGridCell}">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#FFB2DFDB"/>
                    <Setter Property="Foreground" Value="Black"/>
                    <Setter Property="BorderBrush" Value="#FF00796B"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Conditional Formatting Styles -->
        <Style x:Key="ReviztoStatusCellStyle" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsAlternativeMatch}" Value="True">
                    <Setter Property="Background" Value="#FFDAA520"/>
                    <!-- Goldenrod -->
                    <Setter Property="ToolTip" Value="This link is matched to a Revizto entry with a different file extension."/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ReviztoStatus}" Value="Not Matched">
                    <Setter Property="Background" Value="#FFF08080"/>
                    <Setter Property="ToolTip" Value="This link is in Revit but not found in the imported Revizto data."/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ReviztoStatus}" Value="Missing">
                    <Setter Property="Background" Value="#FFFFA07A"/>
                    <Setter Property="ToolTip" Value="This link is in the Revizto data but not currently loaded in Revit."/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ReviztoStatus}" Value="Placeholder">
                    <Setter Property="Background" Value="#FFFFFFE0"/>
                    <Setter Property="ToolTip" Value="This is a manually added placeholder entry."/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ReviztoStatus}" Value="Matched">
                    <Setter Property="Background" Value="#FF90EE90"/>
                    <Setter Property="ToolTip" Value="This link is in Revit and matched with Revizto data."/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ReviztoStatus}" Value="Removed">
                    <Setter Property="Background" Value="#FFD3D3D3"/>
                    <Setter Property="ToolTip" Value="This link was previously matched but is no longer in the Revizto data."/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="DisciplineCellStyle" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding SelectedDiscipline}" Value="Unconfirmed">
                    <Setter Property="Background" Value="#FFD3D3D3"/>
                    <Setter Property="ToolTip" Value="Discipline is unconfirmed. Please update."/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="CoordinatesCellStyle" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsRevitLink}" Value="False">
                    <Setter Property="Background" Value="#FFE0E0E0"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="VersionStatusCellStyle" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding VersionStatus}" Value="Newer local file">
                    <Setter Property="Background" Value="#FFFFD700"/>
                    <Setter Property="ToolTip" Value="The local file is newer than the loaded Revit link. Consider reloading."/>
                </DataTrigger>
                <DataTrigger Binding="{Binding VersionStatus}" Value="Check BIM 360">
                    <Setter Property="Background" Value="#FFADD8E6"/>
                    <Setter Property="ToolTip" Value="Requires BIM 360 integration to check latest version."/>
                </DataTrigger>
                <DataTrigger Binding="{Binding VersionStatus}" Value="N/A (File not found)">
                    <Setter Property="Background" Value="#FFF08080"/>
                    <Setter Property="ToolTip" Value="The linked file could not be found locally."/>
                </DataTrigger>
                <DataTrigger Binding="{Binding VersionStatus}" Value="N/A (Unloaded)">
                    <Setter Property="Background" Value="#FFD3D3D3"/>
                    <Setter Property="ToolTip" Value="Link is unloaded, version status is not applicable."/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Header Filter Style -->
        <Style x:Key="ColumnHeaderFilterStyle" TargetType="{x:Type DataGridColumnHeader}" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridColumnHeader}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ContentPresenter Grid.Column="0" Content="{TemplateBinding Content}" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="5,0"/>
                            <Button Grid.Column="1" Click="ColumnHeader_Click" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,5,0">
                                <Path Data="M0,0 L4,4 L8,0 Z" Fill="White" />
                            </Button>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style for the Pin CheckBox -->
        <Style x:Key="PinCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="IsChecked" Value="{Binding IsPinned, Mode=OneWay}"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsPinned}" Value="{x:Null}">
                    <Setter Property="IsChecked" Value="True"/>
                    <Setter Property="Background" Value="LightGray"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Revizto Status Converter -->
        <local:ReviztoStatusToBrushConverter x:Key="ReviztoStatusToBrushConverter"/>
        <local:ActiveModelStatusToBrushConverter x:Key="ActiveModelStatusToBrushConverter"/>
    </Window.Resources>

    <!-- Main Layout Grid -->
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Header Title -->
            <DockPanel Grid.Column="0" LastChildFill="True">
                <TextBlock FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#FF333333"><Run Text="Link "/><Run Text="Hub"/></TextBlock>
            </DockPanel>

            <!-- Top Right Buttons -->
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                <Button Content="Import CSV" Click="ImportProfileCsvButton_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,10,0"/>
                <Button Content="Export to CSV" Click="ExportToCsvButton_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,10,0"/>
                <Button Content="Import Revizto CSV" Click="ImportReviztoCsvButton_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,10,0"/>
                <Button Content="Clear" Click="ClearProfileButton_Click" Style="{StaticResource ModernButtonStyle}" Width="67"/>
            </StackPanel>
        </Grid>

        <!-- Project Roles & Contacts Grid -->
        <DataGrid x:Name="ProjectRolesGrid"
                  Grid.Row="1"
                  AutoGenerateColumns="False"
                  HeadersVisibility="Column"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserResizeColumns="True"
                  Margin="0,10,0,10"
                  Height="110"
                  VerticalAlignment="Top"
                  ItemsSource="{Binding ProjectRoles}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Role" Binding="{Binding Role}" IsReadOnly="True" Width="2*"/>
                <DataGridTextColumn Header="Name" Binding="{Binding Name, UpdateSourceTrigger=PropertyChanged}" Width="2*"/>
                <DataGridTextColumn Header="Email" Binding="{Binding Email, UpdateSourceTrigger=PropertyChanged}" Width="2.5*"/>
                <DataGridTextColumn Header="Phone" Binding="{Binding Phone, UpdateSourceTrigger=PropertyChanged}" Width="1.5*"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- TabControl -->
        <TabControl Grid.Row="1" x:Name="MainTabControl" Margin="0,130,0,0">
            <!-- Dashboard Tab -->
            <TabItem x:Name="Dashboard_Tab" Header="Dashboard">
                <DataGrid x:Name="DashboardDataGrid"
                          ItemsSource="{Binding Links}"
                          RowHeight="40"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserSortColumns="True"
                          HeadersVisibility="Column"
                          GridLinesVisibility="Horizontal"
                          BorderBrush="#FF00796B"
                          BorderThickness="1"
                          SelectionMode="Extended"
                          Margin="0,10,0,0"
                          ContextMenuOpening="LinksDataGrid_ContextMenuOpening">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="File Name" Binding="{Binding LinkName, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="LinkName" Width="3*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTextColumn Header="Description" Binding="{Binding LinkDescription, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="LinkDescription" Width="2.25*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTemplateColumn Header="Discipline" SortMemberPath="SelectedDiscipline" Width="1*" CellStyle="{StaticResource DisciplineCellStyle}" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding AvailableDisciplines}" SelectedItem="{Binding SelectedDiscipline, UpdateSourceTrigger=PropertyChanged}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Link&#x0a;Status" Binding="{Binding LinkStatus}" IsReadOnly="True" SortMemberPath="LinkStatus" Width="1*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTemplateColumn Header="Project&#x0a;Status" Width="1*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}" SortMemberPath="LinkStatus">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Ellipse Width="12" Height="12" Fill="{Binding ., Converter={StaticResource ActiveModelStatusToBrushConverter}}" Stroke="Black" StrokeThickness="1" ToolTip="{Binding LinkStatus}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Revizto&#x0a;Status" Width="1*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}" SortMemberPath="ReviztoStatus">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Ellipse Width="12" Height="12" Fill="{Binding ReviztoStatus, Converter={StaticResource ReviztoStatusToBrushConverter}}" Stroke="Black" StrokeThickness="1"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Last&#x0a;Modified" Binding="{Binding LastModified}" IsReadOnly="True" SortMemberPath="LastModified" Width="1.2*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTextColumn Header="Version&#x0a;Status" Binding="{Binding VersionStatus}" IsReadOnly="True" SortMemberPath="VersionStatus" Width="1.2*" CellStyle="{StaticResource VersionStatusCellStyle}" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- Management Tab -->
            <TabItem x:Name="Management_Tab" Header="Management">
                <DataGrid x:Name="LinksDataGrid"
                          ItemsSource="{Binding Links}"
                          RowHeight="40"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserSortColumns="True"
                          HeadersVisibility="Column"
                          GridLinesVisibility="Horizontal"
                          BorderBrush="#FF00796B"
                          BorderThickness="1"
                          SelectionMode="Extended"
                          Margin="0,10,0,0"
                          ContextMenuOpening="LinksDataGrid_ContextMenuOpening">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="File Name" Binding="{Binding LinkName, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="LinkName" Width="3*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTextColumn Header="Description" Binding="{Binding LinkDescription, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="LinkDescription" Width="2.25*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTemplateColumn Header="Discipline" SortMemberPath="SelectedDiscipline" Width="1*" CellStyle="{StaticResource DisciplineCellStyle}" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding AvailableDisciplines}" SelectedItem="{Binding SelectedDiscipline, UpdateSourceTrigger=PropertyChanged}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Link Workset" SortMemberPath="LinkWorkset" Width="1.8*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding LinkWorkset}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.CellEditingTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding AvailableWorksets}" SelectedItem="{Binding LinkWorkset, UpdateSourceTrigger=PropertyChanged}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellEditingTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTemplateColumn Header="Pin" SortMemberPath="IsPinned" Width="0.4*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsEnabled="{Binding IsRevitLink}" Style="{StaticResource PinCheckBoxStyle}" HorizontalAlignment="Center" VerticalAlignment="Center" Click="PinCheckBox_Click"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Shared Coordinates" Binding="{Binding LinkCoordinates}" IsReadOnly="True" SortMemberPath="LinkCoordinates" Width="2.8*">
                            <DataGridTextColumn.HeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ColumnHeaderFilterStyle}"/>
                            </DataGridTextColumn.HeaderStyle>
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" BasedOn="{StaticResource CoordinatesCellStyle}">
                                    <EventSetter Event="PreviewMouseRightButtonDown" Handler="CoordinatesCell_PreviewMouseRightButtonDown"/>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Instances" Binding="{Binding NumberOfInstances}" IsReadOnly="True" SortMemberPath="NumberOfInstances" Width="0.6*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTextColumn Header="Path Type" Binding="{Binding PathType}" IsReadOnly="True" SortMemberPath="PathType" Width="1*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTextColumn Header="Comments" Binding="{Binding Comments, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="Comments" Width="2*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- Contacts Tab -->
            <TabItem x:Name="Contacts_Tab" Header="Contacts">
                <DataGrid ItemsSource="{Binding Links}"
                          RowHeight="40"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserSortColumns="True"
                          HeadersVisibility="Column"
                          GridLinesVisibility="Horizontal"
                          BorderBrush="#FF00796B"
                          BorderThickness="1"
                          SelectionMode="Extended"
                          Margin="0,10,0,0">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="File Name" Binding="{Binding LinkName, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="LinkName" Width="3*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTextColumn Header="Description" Binding="{Binding LinkDescription, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="LinkDescription" Width="2.25*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTemplateColumn Header="Discipline" SortMemberPath="SelectedDiscipline" Width="1*" CellStyle="{StaticResource DisciplineCellStyle}" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox ItemsSource="{Binding AvailableDisciplines}" SelectedItem="{Binding SelectedDiscipline, UpdateSourceTrigger=PropertyChanged}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Company Name" Binding="{Binding CompanyName, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="CompanyName" Width="2*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTextColumn Header="Responsible Person" Binding="{Binding ResponsiblePerson, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="ResponsiblePerson" Width="2*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                        <DataGridTextColumn Header="Contact Details" Binding="{Binding ContactDetails, UpdateSourceTrigger=PropertyChanged}" SortMemberPath="ContactDetails" Width="2*" HeaderStyle="{StaticResource ColumnHeaderFilterStyle}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
        </TabControl>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="Profile Settings" Click="ProfileSettingsButton_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,10,0" Width="120"/>
            <Button Content="Add Placeholder" Click="AddPlaceholderButton_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,10,0" Width="121"/>
            <Button Content="Save" Click="SaveButton_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,10,0" Width="54"/>
            <Button Content="Close" Click="CloseButton_Click" Style="{StaticResource ModernButtonStyle}" Width="54"/>
        </StackPanel>
    </Grid>
</Window>
